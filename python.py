import networkx as nx
import matplotlib.pyplot as plt

# 연결 맵 로드
forward_map = {
    "0": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "1": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "2": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26],
    "3": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    "4": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    "5": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    "6": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    "7": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    "8": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    "9": [18, 19, 20, 21, 22, 23, 24, 25, 26],
    "10": [18, 19, 20, 21, 22, 23, 24, 25, 26],
    "11": [18, 19, 20, 21, 22, 23, 24, 25, 26],
    "12": [27, 28, 29],
    "13": [27, 28, 29],
    "14": [27, 28, 29],
    "15": [30, 31, 32],
    "16": [30, 31, 32],
    "17": [30, 31, 32],
    "18": [],
    "19": [],
    "20": [],
    "21": [],
    "22": [],
    "23": [],
    "24": [],
    "25": [],
    "26": [],
    "27": [],
    "28": [],
    "29": [],
    "30": [],
    "31": [],
    "32": []
}

backward_map = {
    "0": [],
    "1": [0, 1, 2, 3, 4, 5, 6, 7, 8],
    "2": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17],
    "3": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "4": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "5": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "6": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "7": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "8": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
    "9": [0, 1, 2, 3, 4, 5, 6, 7, 8],
    "10": [0, 1, 2, 3, 4, 5, 6, 7, 8],
    "11": [0, 1, 2, 3, 4, 5, 6, 7, 8],
    "12": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "13": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "14": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "15": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "16": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "17": [9, 10, 11, 12, 13, 14, 15, 16, 17],
    "18": [18, 19, 20, 21, 22, 23, 24, 25, 26],
    "19": [18, 19, 20, 21, 22, 23, 24, 25, 26],
    "20": [18, 19, 20, 21, 22, 23, 24, 25, 26],
    "21": [27, 28, 29],
    "22": [27, 28, 29],
    "23": [27, 28, 29],
    "24": [30, 31, 32],
    "25": [30, 31, 32],
    "26": [30, 31, 32],
    "27": [33, 34, 35],
    "28": [33, 34, 35],
    "29": [33, 34, 35],
    "30": [36, 37, 38],
    "31": [36, 37, 38],
    "32": [36, 37, 38]
}

# 네트워크 그래프 생성
G = nx.DiGraph()

# 노드 추가
for layer in forward_map.keys():
    for node in forward_map[layer]:
        G.add_node(node)

# 전방향 링크 추가
for layer in forward_map.keys():
    for node in forward_map[layer]:
        for next_node in forward_map[str(int(layer)+1)]:
            G.add_edge(node, next_node)

# 후방향 링크 추가
for layer in backward_map.keys():
    for node in backward_map[layer]:
        for prev_node in backward_map[str(int(layer)-1)]:
            G.add_edge(node, prev_node)

# 네트워크 그래프 시각화
plt.figure(figsize=(12, 8))
pos = nx.spring_layout(G)  # 노드 위치 결정
nx.draw_networkx_nodes(G, pos, node_size=300, node_color='skyblue')  # 노드 그리기
nx.draw_networkx_edges(G, pos, edge_color='gray')  # 엣지 그리기
nx.draw_networkx_labels(G, pos, font_size=10, font_family='sans-serif')  # 노드 라벨 그리기
plt.title('Neural Network Visualization')
plt.axis('off')  # 축 제거
plt.show()